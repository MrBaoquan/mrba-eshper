{"version":3,"file":"index.mjs","sources":["../../src/utils/ESUtils.ts","../../src/utils/Logger.ts","../../src/utils/Singleton.ts"],"sourcesContent":["/**\n * target 不为null并且不为undefined 时返回 true\n * @param target 目标\n */\nexport function isset(target:any):boolean{\n    return target!==null&&target!==undefined;\n}\n\n/**\n * 格式字符串\n * @example\n * FormatString(\"hello {0}\", \"world\"); output: hello world\n * @param str \n * @param args \n */\nexport function FormatString(str:string,...args:any[]){\n    return args.reduce((str:string,_arg,_index)=>str.replace(`{${_index}}`,_arg),str);\n}\n\n/**\n * 调用函数 基于反射 Reflect.apply\n * @param func 函数实体\n * @param thisArgument 回调 function的this参数\n * @param args 参数列表\n */\nexport function CallFunction(func:Function, thisArgument?:any, ...args:any[]):any;\n/**\n * 调用对象上的某个方法\n * @param target 对象\n * @param func 方法名称\n * @param args 参数列表\n */\nexport function CallFunction(target:object, func:string, ...args:any[]):any;\nexport function CallFunction(target:object|Function,  thisOrFunc:string|undefined, ...args:any[]):any{\n    if(!isset(target)) return null;\n    if(typeof target==='function'){\n        return Reflect.apply(<Function>target,thisOrFunc,args);\n    }else if(typeof target==='object'){\n        let _func = Reflect.get(target,thisOrFunc!,args);\n        if(!isset(_func)) return;\n        return CallFunction(<Function>_func,target,...args);\n    }\n    return null;\n}\n\n/**\n * \n * @param arr 被迭代的数组\n * @param callback 迭代的元素key, 用于标记完成的finishStep\n * @param onFinished 遍历结束回调\n */\nexport function ParallelForEach<T>(arr:Array<T>, callback:(key:T,finishStep:Function)=>void, onFinished:Function){\n    let _iteratorCount = 0;\n    let _func = ()=>{\n        if(++_iteratorCount>=arr.length)\n            onFinished();\n    };\n    for(let _key of arr){\n        callback(_key,_func);\n    }\n}\n","import moment from \"moment\";\n\ntype LogAction = (...args:any[])=>void;\n\nexport class Logger{\n    \n    private static info:LogAction = console.log;\n    private static warn:LogAction = console.warn;\n    private static error:LogAction = console.error;\n\n    private static logable:boolean = true;\n    static Enable(){\n        this.logable = true;\n    }\n\n    static Disable(){\n        this.logable = false;\n    }\n\n    static Register(params:{info?:LogAction, warn?:LogAction, error?:LogAction}){\n        if(params.info)\n            this.info = params.info;\n        if(params.warn)\n            this.warn = params.warn;\n        if(params.error)\n            this.error = params.error;\n    }\n\n    static  Log(message?: any, ...optionalParams: any[]){\n        Logger.doLogger(this.info,message,...optionalParams);\n    }\n\n    static  Warn(message?: any, ...optionalParams: any[]){\n        Logger.doLogger(this.warn,message,...optionalParams);\n    }\n\n    static  Error(message?: any, ...optionalParams: any[]){\n        Logger.doLogger(this.error,message,...optionalParams);\n    }\n\n    /**\n     * examples \n     */\n    private static doLogger(action:{(message?: any, ...optionalParams: any[]):void}, message?: any, ...optionalParams: any[]){\n        if(!this.logable) return;\n        let _timePrefix:string = moment().format(\"YYYY-MM-DD HH:mm:ss.SSS\") + \": \";\n        if(typeof message==='string')\n            action(_timePrefix + message, ...optionalParams);\n        else\n            action(_timePrefix, message);\n    }\n}","  \nexport const SINGLETON_KEY = Symbol()\n\nexport type Singleton<T extends new (...args: any[]) => any> = T & {\n  [SINGLETON_KEY]: T extends new (...args: any[]) => infer I ? I : never\n}\nexport const singleton = <T extends new (...args: any[]) => any>(classTarget: T) =>\n  new Proxy(classTarget, {\n    construct(target: Singleton<T>, argumentsList, newTarget) {\n      // Skip proxy for children\n      if (target.prototype !== newTarget.prototype) {\n        return Reflect.construct(target, argumentsList, newTarget)\n      }\n      if (!target[SINGLETON_KEY]) {\n        target[SINGLETON_KEY] = Reflect.construct(target, argumentsList, newTarget)\n      }\n      return target[SINGLETON_KEY]\n    },\n  })"],"names":[],"mappings":"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"}